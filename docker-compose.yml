version: "3"
services:
  javascripts:
    image: nycdavid/postapoc-js:0.0.1
    volumes:
      - js_volume:/app/dist
      - ./docker.javascripts.src/src:/app/src
  stylesheets:
    image: nycdavid/postapoc-css:0.0.1
    volumes:
      - css_volume:/app/dist
      - ./docker.stylesheets.src/src:/app/src
  postapoc:
    image: nycdavid/postapoc:0.0.1
    environment:
      - PORT=3000
    ports:
      - "3000:3000"
    volumes:
      - js_volume:/go/src/app/dist/javascripts
      - css_volume:/go/src/app/dist/stylesheets
      - ./static:/go/src/app/dist/static
      - ./main.go:/go/src/app/main.go
      - ./healthcheck:/go/src/app/healthcheck
    depends_on:
      - javascripts
      - stylesheets
      - postgres
  postgres:
    image: postgres:10.3-alpine

volumes:
  js_volume:
  css_volume:
